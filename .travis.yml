language: cpp
sudo: required
compiler:
 - clang
os:
 - linux
dist: focal
arch:
  - arm64
  - amd64

addons:
  apt:
    packages:
      - libxkbcommon-x11-0
      - libgl1-mesa-dev

services: 
  - xvfb

script:
  # patch install.sh
  - sed -i 's/libusb-1.0.0-dev/libusb-1.0-0-dev/g' install.sh
  - sed -i 's/^\s*\.\/dash/\# \.\/dash/g' install.sh
  # run build
  - ./install.sh
  # run app and check logs
  - ./bin/dash > dash.log
  - grep 'Init complete!' dash.log
